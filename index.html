<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Microsoft Graph Toolkit Test</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://unpkg.com/@webcomponents/webcomponentsjs/webcomponents-bundle.js"></script>

    <!-- <script type="module" src="./dist/es6/components/graph-login/graph-login.js"></script>
    <script type="module" src="./dist/es6/components/graph-persona/graph-persona.js"></script>
    <script type="module" src="./dist/es6/components/graph-agenda/graph-agenda.js"></script>
    <script type="module" src="./dist/es6/components/providers/graph-msal-provider/graph-msal-provider.js"></script> -->

    <script type="module" src="./dist/es6/index.js"></script>

    <!-- <script src="./dist/es5/ms-graph-toolkit.js"></script> -->

    <style>
      /* todo: @font-face doesn't work inside ShadowDom...
         https://bugs.chromium.org/p/chromium/issues/detail?id=336876
         Might just use svg directly. */
      @font-face {
        font-family: 'FabricMDL2Icons';
        src: url('/src/fonts/fabric-icons.woff') format('woff');
      }
    </style>
  </head>
  <body>
    <!-- <graph-msal-provider
      test="test"
      client-id="a974dfa0-9f57-49b9-95db-90f04ce2111a"
    ></graph-msal-provider> -->
    <graph-login style="float: right;"></graph-login>
    <graph-agenda id="myDay"></graph-agenda>

    <script type="module">
        import {Providers, MsalProvider} from './dist/es6/index.js'
        import {UserAgentApplication} from "./node_modules/msal/lib-es6/index.js";

        

        let userAgentApplication = new UserAgentApplication(
          "a974dfa0-9f57-49b9-95db-90f04ce2111a",
          null,
          callbackFunction);

        let provider = MsalProvider.createFromUserAgentApplication(userAgentApplication);
        
        Providers.add(provider);

        // Providers.addMsalProvider({
        //     clientId: 'a974dfa0-9f57-49b9-95db-90f04ce2111a'
        // });

        function callbackFunction(errorDesc, token, error, tokenType, state){
          provider.tokenReceivedCallback(errorDesc, token, error, tokenType, state);
        }

    </script>

    <!-- <script>
        msGraphToolkit.Providers.addMsalProvider({
            clientId: 'a974dfa0-9f57-49b9-95db-90f04ce2111a'
        });
    </script> -->

    <!-- <template id="my-template">
        <style>
            .eventBtn {
            background: green;
            }
        </style>
        <button class="eventBtn">EVENT NAME GOES HERE</button>
    </template>

    <script type="module">
        let myDay = document.getElementById('myDay');

        // myDay.eventTemplateFunction = (event) => {
        //   return html`<style>
        //       .testbtn {
        //         background: red;
        //       }
        //     </style>
        //     <button class="testbtn">${event.subject}</button>`
        // }

        // myDay.eventTemplateFunction = (event) => {
        //     let template = document.getElementById("my-template");
        //     let templateContent = template.content.cloneNode(true);

        //     let btn = templateContent.querySelector('.eventBtn');
        //     btn.innerHTML = event.subject;
        //     btn.onclick = function () {
        //     console.log(`${event.subject} clicked`);
        //     }
        //     return templateContent;
        // };
    </script> -->
  </body>
</html>
