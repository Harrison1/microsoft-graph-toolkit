<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Microsoft Graph Toolkit Test</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" rel="stylesheet" />
    <!-- <script src="./node_modules/@webcomponents/webcomponentsjs/webcomponents-loader.js"></script> -->

    <script src="./dist/bundle/mgt-loader.js"></script>
    <!-- <script type="module" src="dist/es6/index.js"></script> -->

    <!-- <script src="https://unpkg.com/@microsoft/mgt/dist/bundle/mgt-loader.js"></script> -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.21.1/babel.min.js"></script>

    <script type="module" src="./dist/es6/components/mgt-login/mgt-login.js"></script>
    <script type="module" src="./dist/es6/components/mgt-agenda/mgt-agenda.js"></script>
    <script type="module" src="./dist/es6/components/mgt-people/mgt-people.js"></script>
    <script type="module" src="./dist/es6/components/mgt-picker/mgt-people-picker.js"></script>
    <script type="module" src="./dist/es6/mock/mgt-mock-provider.js"></script>
    <script type="module" src="./dist/es6/components/providers/mgt-msal-provider.js"></script>
    <script type="module" src="./dist/es6/components/mgt-tasks/mgt-tasks.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.4.2/react.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.4.2/react-dom.js"></script>
  </head>

  <body>
    <mgt-mock-provider></mgt-mock-provider>

    <div style="max-width: 400px; max-height: 400px">
      <mgt-people-picker id="picker1"></mgt-people-picker>
    </div>

    <div style="position: fixed; bottom: 0;">
      <h3>Chosen People:</h3>
      <ul id="chosenPeople"></ul>
    </div>
  </body>
  <script>
    let picker1 = document.getElementById('picker1');
    let chosenArea = document.getElementById('chosenPeople');

    picker1.addEventListener('selectedPeople', function(e) {
      //reset area
      chosenArea.innerHTML = '';
      //render selected people to chosen people div
      for (var i = 0; i < e.detail.length; i++) {
        let newElem = document.createElement('li');
        newElem.innerHTML = e.detail[i].displayName + ' ' + e.detail[i].id;
        chosenArea.append(newElem);
      }
    });
  </script>
</html>
